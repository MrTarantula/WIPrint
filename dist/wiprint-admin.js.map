{"version":3,"sources":["webpack:///wiprint-admin.js","webpack:///webpack/bootstrap 00f3071413185bc90bd8?3fc9","webpack:///external \"TFS/WorkItemTracking/RestClient\"?9a50","webpack:///external \"VSS/Context\"","webpack:///external \"VSS/Controls/Dialogs\"","webpack:///./src/wiprint-admin.ts"],"names":["define","__WEBPACK_EXTERNAL_MODULE_0__","__WEBPACK_EXTERNAL_MODULE_2__","__WEBPACK_EXTERNAL_MODULE_3__","modules","__webpack_require__","moduleId","installedModules","exports","module","i","l","call","m","c","value","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","__WEBPACK_AMD_DEFINE_ARRAY__","__WEBPACK_AMD_DEFINE_RESULT__","undefined","require","Context","WITClient","Dialogs","selectSelected","activeSelected","$","sanitize","removeClass","selectedFields","filter","field","addClass","selectAll","activeAll","allFields","type","save","saveFields","slice","makeClean","dataService","then","service","setValue","key","scopeType","refreshData","dirty","dialog_1","show","ModalDialog","title","content","html","activeType","buttons","Save","close","No","Cancel","types","splice","length","getValue","data","forEach","push","populateSelected","append","fieldInstances","len","referenceName","populateAll","makeDirty","prop","sort","a","b","click","e","tfsContext","getDefaultWebContext","VSS","getService","ServiceIds","ExtensionData","witClient","getClient","getWorkItemTypes","project","witypes","color","description","allIndex","indexOf","selectedIndex","unshift","index","String","this","replace","apply"],"mappings":"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","file":"wiprint-admin.js","sourcesContent":["define([\"TFS/WorkItemTracking/RestClient\",\"VSS/Context\",\"VSS/Controls/Dialogs\"], function(__WEBPACK_EXTERNAL_MODULE_0__, __WEBPACK_EXTERNAL_MODULE_2__, __WEBPACK_EXTERNAL_MODULE_3__) { return /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmony imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 6);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports) {\n\nmodule.exports = __WEBPACK_EXTERNAL_MODULE_0__;\n\n/***/ }),\n/* 1 */,\n/* 2 */\n/***/ (function(module, exports) {\n\nmodule.exports = __WEBPACK_EXTERNAL_MODULE_2__;\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports) {\n\nmodule.exports = __WEBPACK_EXTERNAL_MODULE_3__;\n\n/***/ }),\n/* 4 */,\n/* 5 */,\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__, exports, __webpack_require__(2), __webpack_require__(0), __webpack_require__(3)], __WEBPACK_AMD_DEFINE_RESULT__ = function (require, exports, Context, WITClient, Dialogs) {\r\n    \"use strict\";\r\n    Object.defineProperty(exports, \"__esModule\", { value: true });\r\n    var tfsContext = Context.getDefaultWebContext();\r\n    var dataService = VSS.getService(VSS.ServiceIds.ExtensionData);\r\n    var witClient = WITClient.getClient();\r\n    var allFields = [];\r\n    var selectedFields = [];\r\n    var types = [];\r\n    var key;\r\n    var dirty = false;\r\n    var activeType;\r\n    var activeSelected;\r\n    var activeAll;\r\n    var typesList;\r\n    function selectSelected(name) {\r\n        if (activeSelected) {\r\n            $(\"#selected-\" + activeSelected.name.sanitize()).removeClass(\"selected\");\r\n        }\r\n        activeSelected = selectedFields.filter(function (field) {\r\n            return field.name === name;\r\n        })[0];\r\n        $(\"#selected-\" + name.sanitize()).addClass(\"selected\");\r\n    }\r\n    function selectAll(name) {\r\n        if (activeAll) {\r\n            $(\"#all-\" + activeAll.name.sanitize()).removeClass(\"selected\");\r\n        }\r\n        activeAll = allFields.filter(function (type) {\r\n            return type.name === name;\r\n        })[0];\r\n        $(\"#all-\" + name.sanitize()).addClass(\"selected\");\r\n    }\r\n    makeClean();\r\n    witClient.getWorkItemTypes(tfsContext.project.name).then(function (witypes) {\r\n        witypes.forEach(function (type) {\r\n            types.push(type);\r\n            $(\"#typesList\").append(\"<li id=\\\"type-\" + type.name.sanitize() + \"\\\" class=\\\"ms-ListItem\\\">\" +\r\n                (type.color ?\r\n                    \"<span class=\\\"ms-ListItem-image\\\" style=\\\"background-color: #\" + type.color + \"\\\"></span>\" :\r\n                    \"\") +\r\n                (\"<span class=\\\"ms-ListItem-primaryText\\\">\" + type.name + \"</span>\") +\r\n                (\"<span class=\\\"ms-ListItem-secondaryText\\\">\" + type.description + \"</span>\") +\r\n                \"</li>\");\r\n            $(\"#type-\" + type.name.sanitize()).click(function (e) {\r\n                refreshData(type.name);\r\n            });\r\n        });\r\n    });\r\n    $(\"#save\").click(function (e) { return save(activeType.name); });\r\n    $(\"#cancel\").click(function (e) {\r\n        makeClean();\r\n        refreshData(activeType.name);\r\n    });\r\n    function save(name) {\r\n        var saveFields = selectedFields.slice();\r\n        makeClean();\r\n        activeAll = null;\r\n        activeSelected = null;\r\n        dataService.then(function (service) {\r\n            service.setValue(key, saveFields, { scopeType: \"user\" }).then(function () {\r\n                refreshData(name);\r\n            });\r\n        });\r\n    }\r\n    function refreshData(name) {\r\n        if (dirty) {\r\n            var dialog_1 = Dialogs.show(Dialogs.ModalDialog, {\r\n                title: \"Unsaved Changes\",\r\n                content: $(\"<p/>\").addClass(\"confirmation-text\").html(\"Do you want to save changes for <b>\" + activeType.name + \"</b>?\"),\r\n                buttons: {\r\n                    \"Save\": function () {\r\n                        save(name);\r\n                        dialog_1.close();\r\n                    },\r\n                    \"No\": function () {\r\n                        makeClean();\r\n                        activeAll = null;\r\n                        activeSelected = null;\r\n                        refreshData(name);\r\n                        dialog_1.close();\r\n                    },\r\n                    \"Cancel\": function () {\r\n                        dialog_1.close();\r\n                    }\r\n                }\r\n            });\r\n        }\r\n        else {\r\n            if (activeType) {\r\n                $(\"#type-\" + activeType.name.sanitize()).removeClass(\"selected\");\r\n            }\r\n            activeType = types.filter(function (type) {\r\n                return type.name === name;\r\n            })[0];\r\n            $(\"#type-\" + name.sanitize()).addClass(\"selected\");\r\n            key = \"wiprint-\" + activeType.name.sanitize();\r\n            $(\"#allList\").html(\"\");\r\n            allFields.splice(0, allFields.length);\r\n            $(\"#selectedList\").html(\"\");\r\n            selectedFields.splice(0, selectedFields.length);\r\n            dataService.then(function (service) {\r\n                service.getValue(key, { scopeType: \"user\" })\r\n                    .then(function (data) {\r\n                    if (data && data.length > 0) {\r\n                        data.forEach(function (field) {\r\n                            if (field !== null) {\r\n                                selectedFields.push(field);\r\n                            }\r\n                        });\r\n                        populateSelected();\r\n                    }\r\n                    else {\r\n                        $(\"#selectedList\").append(\"<li class=\\\"ms-ListItem\\\">\" +\r\n                            \"<span class=\\\"ms-ListItem-secondaryText\\\">No Saved Data</span>\" +\r\n                            \"</li>\");\r\n                    }\r\n                })\r\n                    .then(function () {\r\n                    activeType.fieldInstances\r\n                        .filter(function (field) {\r\n                        for (var i = 0, len = selectedFields.length; i < len; i++) {\r\n                            if (field.referenceName === selectedFields[i].referenceName) {\r\n                                return false;\r\n                            }\r\n                        }\r\n                        return true;\r\n                    })\r\n                        .forEach(function (field) {\r\n                        allFields.push(field);\r\n                    });\r\n                    populateAll();\r\n                });\r\n            });\r\n        }\r\n    }\r\n    function makeDirty() {\r\n        if (!dirty) {\r\n            dirty = true;\r\n            $(\"#save\").prop(\"disabled\", false);\r\n            $(\"#cancel\").prop(\"disabled\", false);\r\n        }\r\n    }\r\n    function makeClean() {\r\n        dirty = false;\r\n        $(\"#save\").prop(\"disabled\", true);\r\n        $(\"#cancel\").prop(\"disabled\", true);\r\n    }\r\n    function populateAll() {\r\n        $(\"#allList\").html(\"\");\r\n        allFields\r\n            .sort(function (a, b) { return a.name > b.name ? 1 : -1; })\r\n            .forEach(function (field) {\r\n            $(\"#allList\").append(\"<li id=\\\"all-\" + field.name.sanitize() + \"\\\" class=\\\"ms-ListItem\\\">\" +\r\n                (\"<span class=\\\"ms-ListItem-secondaryText\\\">\" + field.name + \"</span>\") +\r\n                \"</li>\");\r\n            $(\"#all-\" + field.name.sanitize()).click(function (e) {\r\n                selectAll(field.name);\r\n            });\r\n        });\r\n    }\r\n    function populateSelected() {\r\n        $(\"#selectedList\").html(\"\");\r\n        selectedFields.forEach(function (field) {\r\n            $(\"#selectedList\").append(\"<li id=\\\"selected-\" + field.name.sanitize() + \"\\\" class=\\\"ms-ListItem\\\">\" +\r\n                (\"<span class=\\\"ms-ListItem-secondaryText\\\">\" + field.name + \"</span>\") +\r\n                \"</li>\");\r\n            $(\"#selected-\" + field.name.sanitize()).click(function (e) {\r\n                selectSelected(field.name);\r\n            });\r\n        });\r\n    }\r\n    $(\"#push\").click(function (e) {\r\n        if (activeAll) {\r\n            var allIndex = allFields.indexOf(activeAll);\r\n            var selectedIndex = selectedFields.indexOf(activeSelected) === -1 ?\r\n                selectedFields.length - 1 : selectedFields.indexOf(activeSelected);\r\n            allFields.splice(allIndex, 1);\r\n            selectedFields.splice(selectedIndex + 1, 0, activeAll);\r\n            populateAll();\r\n            if (allFields.length > 0) {\r\n                $(\"#all-\" + allFields[allFields[allIndex] ? allIndex : allIndex - 1].name.sanitize()).click();\r\n            }\r\n            else {\r\n                activeAll = null;\r\n            }\r\n            populateSelected();\r\n            $(\"#selected-\" + selectedFields[selectedFields[selectedIndex + 1] ? selectedIndex + 1 : selectedIndex].name.sanitize()).click();\r\n            makeDirty();\r\n        }\r\n    });\r\n    $(\"#pop\").click(function (e) {\r\n        if (activeSelected) {\r\n            var selectedIndex = selectedFields.indexOf(activeSelected);\r\n            selectedFields.splice(selectedIndex, 1);\r\n            allFields.push(activeSelected);\r\n            populateSelected();\r\n            populateAll();\r\n            $(\"#all-\" + allFields[allFields.indexOf(activeSelected)].name.sanitize()).click();\r\n            if (selectedFields.length > 0) {\r\n                $(\"#selected-\" + selectedFields[selectedFields[selectedIndex] ? selectedIndex : selectedIndex - 1].name.sanitize()).click();\r\n            }\r\n            else {\r\n                activeSelected = null;\r\n            }\r\n            makeDirty();\r\n        }\r\n    });\r\n    $(\"#top\").click(function (e) {\r\n        if (activeSelected && selectedFields.indexOf(activeSelected) > 0) {\r\n            selectedFields.splice(selectedFields.indexOf(activeSelected), 1);\r\n            selectedFields.unshift(activeSelected);\r\n            populateSelected();\r\n            $(\"#selected-\" + selectedFields[0].name.sanitize()).click();\r\n        }\r\n    });\r\n    $(\"#bottom\").click(function (e) {\r\n        if (activeSelected && selectedFields.indexOf(activeSelected) < selectedFields.length) {\r\n            selectedFields.splice(selectedFields.indexOf(activeSelected), 1);\r\n            selectedFields.push(activeSelected);\r\n            populateSelected();\r\n            $(\"#selected-\" + selectedFields[selectedFields.length - 1].name.sanitize()).click();\r\n        }\r\n    });\r\n    $(\"#up\").click(function (e) {\r\n        if (activeSelected && selectedFields.indexOf(activeSelected) > 0) {\r\n            var index = selectedFields.indexOf(activeSelected);\r\n            selectedFields.splice(index, 1);\r\n            selectedFields.splice(index - 1, 0, activeSelected);\r\n            populateSelected();\r\n            $(\"#selected-\" + selectedFields[index - 1].name.sanitize()).click();\r\n        }\r\n    });\r\n    $(\"#down\").click(function (e) {\r\n        if (activeSelected && selectedFields.indexOf(activeSelected) < selectedFields.length) {\r\n            var index = selectedFields.indexOf(activeSelected);\r\n            selectedFields.splice(index, 1);\r\n            selectedFields.splice(index + 1, 0, activeSelected);\r\n            populateSelected();\r\n            $(\"#selected-\" + selectedFields[selectedFields[index + 1] ? index + 1 : index].name.sanitize()).click();\r\n        }\r\n    });\r\n    String.prototype.sanitize = function () {\r\n        return this.replace(/\\s/g, \"-\");\r\n    };\r\n}.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\r\n\n\n/***/ })\n/******/ ])});;\n\n\n// WEBPACK FOOTER //\n// wiprint-admin.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 6);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 00f3071413185bc90bd8","module.exports = __WEBPACK_EXTERNAL_MODULE_0__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"TFS/WorkItemTracking/RestClient\"\n// module id = 0\n// module chunks = 0 1","module.exports = __WEBPACK_EXTERNAL_MODULE_2__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"VSS/Context\"\n// module id = 2\n// module chunks = 1","module.exports = __WEBPACK_EXTERNAL_MODULE_3__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"VSS/Controls/Dialogs\"\n// module id = 3\n// module chunks = 1","define([\"require\", \"exports\", \"VSS/Context\", \"TFS/WorkItemTracking/RestClient\", \"VSS/Controls/Dialogs\"], function (require, exports, Context, WITClient, Dialogs) {\r\n    \"use strict\";\r\n    Object.defineProperty(exports, \"__esModule\", { value: true });\r\n    var tfsContext = Context.getDefaultWebContext();\r\n    var dataService = VSS.getService(VSS.ServiceIds.ExtensionData);\r\n    var witClient = WITClient.getClient();\r\n    var allFields = [];\r\n    var selectedFields = [];\r\n    var types = [];\r\n    var key;\r\n    var dirty = false;\r\n    var activeType;\r\n    var activeSelected;\r\n    var activeAll;\r\n    var typesList;\r\n    function selectSelected(name) {\r\n        if (activeSelected) {\r\n            $(\"#selected-\" + activeSelected.name.sanitize()).removeClass(\"selected\");\r\n        }\r\n        activeSelected = selectedFields.filter(function (field) {\r\n            return field.name === name;\r\n        })[0];\r\n        $(\"#selected-\" + name.sanitize()).addClass(\"selected\");\r\n    }\r\n    function selectAll(name) {\r\n        if (activeAll) {\r\n            $(\"#all-\" + activeAll.name.sanitize()).removeClass(\"selected\");\r\n        }\r\n        activeAll = allFields.filter(function (type) {\r\n            return type.name === name;\r\n        })[0];\r\n        $(\"#all-\" + name.sanitize()).addClass(\"selected\");\r\n    }\r\n    makeClean();\r\n    witClient.getWorkItemTypes(tfsContext.project.name).then(function (witypes) {\r\n        witypes.forEach(function (type) {\r\n            types.push(type);\r\n            $(\"#typesList\").append(\"<li id=\\\"type-\" + type.name.sanitize() + \"\\\" class=\\\"ms-ListItem\\\">\" +\r\n                (type.color ?\r\n                    \"<span class=\\\"ms-ListItem-image\\\" style=\\\"background-color: #\" + type.color + \"\\\"></span>\" :\r\n                    \"\") +\r\n                (\"<span class=\\\"ms-ListItem-primaryText\\\">\" + type.name + \"</span>\") +\r\n                (\"<span class=\\\"ms-ListItem-secondaryText\\\">\" + type.description + \"</span>\") +\r\n                \"</li>\");\r\n            $(\"#type-\" + type.name.sanitize()).click(function (e) {\r\n                refreshData(type.name);\r\n            });\r\n        });\r\n    });\r\n    $(\"#save\").click(function (e) { return save(activeType.name); });\r\n    $(\"#cancel\").click(function (e) {\r\n        makeClean();\r\n        refreshData(activeType.name);\r\n    });\r\n    function save(name) {\r\n        var saveFields = selectedFields.slice();\r\n        makeClean();\r\n        activeAll = null;\r\n        activeSelected = null;\r\n        dataService.then(function (service) {\r\n            service.setValue(key, saveFields, { scopeType: \"user\" }).then(function () {\r\n                refreshData(name);\r\n            });\r\n        });\r\n    }\r\n    function refreshData(name) {\r\n        if (dirty) {\r\n            var dialog_1 = Dialogs.show(Dialogs.ModalDialog, {\r\n                title: \"Unsaved Changes\",\r\n                content: $(\"<p/>\").addClass(\"confirmation-text\").html(\"Do you want to save changes for <b>\" + activeType.name + \"</b>?\"),\r\n                buttons: {\r\n                    \"Save\": function () {\r\n                        save(name);\r\n                        dialog_1.close();\r\n                    },\r\n                    \"No\": function () {\r\n                        makeClean();\r\n                        activeAll = null;\r\n                        activeSelected = null;\r\n                        refreshData(name);\r\n                        dialog_1.close();\r\n                    },\r\n                    \"Cancel\": function () {\r\n                        dialog_1.close();\r\n                    }\r\n                }\r\n            });\r\n        }\r\n        else {\r\n            if (activeType) {\r\n                $(\"#type-\" + activeType.name.sanitize()).removeClass(\"selected\");\r\n            }\r\n            activeType = types.filter(function (type) {\r\n                return type.name === name;\r\n            })[0];\r\n            $(\"#type-\" + name.sanitize()).addClass(\"selected\");\r\n            key = \"wiprint-\" + activeType.name.sanitize();\r\n            $(\"#allList\").html(\"\");\r\n            allFields.splice(0, allFields.length);\r\n            $(\"#selectedList\").html(\"\");\r\n            selectedFields.splice(0, selectedFields.length);\r\n            dataService.then(function (service) {\r\n                service.getValue(key, { scopeType: \"user\" })\r\n                    .then(function (data) {\r\n                    if (data && data.length > 0) {\r\n                        data.forEach(function (field) {\r\n                            if (field !== null) {\r\n                                selectedFields.push(field);\r\n                            }\r\n                        });\r\n                        populateSelected();\r\n                    }\r\n                    else {\r\n                        $(\"#selectedList\").append(\"<li class=\\\"ms-ListItem\\\">\" +\r\n                            \"<span class=\\\"ms-ListItem-secondaryText\\\">No Saved Data</span>\" +\r\n                            \"</li>\");\r\n                    }\r\n                })\r\n                    .then(function () {\r\n                    activeType.fieldInstances\r\n                        .filter(function (field) {\r\n                        for (var i = 0, len = selectedFields.length; i < len; i++) {\r\n                            if (field.referenceName === selectedFields[i].referenceName) {\r\n                                return false;\r\n                            }\r\n                        }\r\n                        return true;\r\n                    })\r\n                        .forEach(function (field) {\r\n                        allFields.push(field);\r\n                    });\r\n                    populateAll();\r\n                });\r\n            });\r\n        }\r\n    }\r\n    function makeDirty() {\r\n        if (!dirty) {\r\n            dirty = true;\r\n            $(\"#save\").prop(\"disabled\", false);\r\n            $(\"#cancel\").prop(\"disabled\", false);\r\n        }\r\n    }\r\n    function makeClean() {\r\n        dirty = false;\r\n        $(\"#save\").prop(\"disabled\", true);\r\n        $(\"#cancel\").prop(\"disabled\", true);\r\n    }\r\n    function populateAll() {\r\n        $(\"#allList\").html(\"\");\r\n        allFields\r\n            .sort(function (a, b) { return a.name > b.name ? 1 : -1; })\r\n            .forEach(function (field) {\r\n            $(\"#allList\").append(\"<li id=\\\"all-\" + field.name.sanitize() + \"\\\" class=\\\"ms-ListItem\\\">\" +\r\n                (\"<span class=\\\"ms-ListItem-secondaryText\\\">\" + field.name + \"</span>\") +\r\n                \"</li>\");\r\n            $(\"#all-\" + field.name.sanitize()).click(function (e) {\r\n                selectAll(field.name);\r\n            });\r\n        });\r\n    }\r\n    function populateSelected() {\r\n        $(\"#selectedList\").html(\"\");\r\n        selectedFields.forEach(function (field) {\r\n            $(\"#selectedList\").append(\"<li id=\\\"selected-\" + field.name.sanitize() + \"\\\" class=\\\"ms-ListItem\\\">\" +\r\n                (\"<span class=\\\"ms-ListItem-secondaryText\\\">\" + field.name + \"</span>\") +\r\n                \"</li>\");\r\n            $(\"#selected-\" + field.name.sanitize()).click(function (e) {\r\n                selectSelected(field.name);\r\n            });\r\n        });\r\n    }\r\n    $(\"#push\").click(function (e) {\r\n        if (activeAll) {\r\n            var allIndex = allFields.indexOf(activeAll);\r\n            var selectedIndex = selectedFields.indexOf(activeSelected) === -1 ?\r\n                selectedFields.length - 1 : selectedFields.indexOf(activeSelected);\r\n            allFields.splice(allIndex, 1);\r\n            selectedFields.splice(selectedIndex + 1, 0, activeAll);\r\n            populateAll();\r\n            if (allFields.length > 0) {\r\n                $(\"#all-\" + allFields[allFields[allIndex] ? allIndex : allIndex - 1].name.sanitize()).click();\r\n            }\r\n            else {\r\n                activeAll = null;\r\n            }\r\n            populateSelected();\r\n            $(\"#selected-\" + selectedFields[selectedFields[selectedIndex + 1] ? selectedIndex + 1 : selectedIndex].name.sanitize()).click();\r\n            makeDirty();\r\n        }\r\n    });\r\n    $(\"#pop\").click(function (e) {\r\n        if (activeSelected) {\r\n            var selectedIndex = selectedFields.indexOf(activeSelected);\r\n            selectedFields.splice(selectedIndex, 1);\r\n            allFields.push(activeSelected);\r\n            populateSelected();\r\n            populateAll();\r\n            $(\"#all-\" + allFields[allFields.indexOf(activeSelected)].name.sanitize()).click();\r\n            if (selectedFields.length > 0) {\r\n                $(\"#selected-\" + selectedFields[selectedFields[selectedIndex] ? selectedIndex : selectedIndex - 1].name.sanitize()).click();\r\n            }\r\n            else {\r\n                activeSelected = null;\r\n            }\r\n            makeDirty();\r\n        }\r\n    });\r\n    $(\"#top\").click(function (e) {\r\n        if (activeSelected && selectedFields.indexOf(activeSelected) > 0) {\r\n            selectedFields.splice(selectedFields.indexOf(activeSelected), 1);\r\n            selectedFields.unshift(activeSelected);\r\n            populateSelected();\r\n            $(\"#selected-\" + selectedFields[0].name.sanitize()).click();\r\n        }\r\n    });\r\n    $(\"#bottom\").click(function (e) {\r\n        if (activeSelected && selectedFields.indexOf(activeSelected) < selectedFields.length) {\r\n            selectedFields.splice(selectedFields.indexOf(activeSelected), 1);\r\n            selectedFields.push(activeSelected);\r\n            populateSelected();\r\n            $(\"#selected-\" + selectedFields[selectedFields.length - 1].name.sanitize()).click();\r\n        }\r\n    });\r\n    $(\"#up\").click(function (e) {\r\n        if (activeSelected && selectedFields.indexOf(activeSelected) > 0) {\r\n            var index = selectedFields.indexOf(activeSelected);\r\n            selectedFields.splice(index, 1);\r\n            selectedFields.splice(index - 1, 0, activeSelected);\r\n            populateSelected();\r\n            $(\"#selected-\" + selectedFields[index - 1].name.sanitize()).click();\r\n        }\r\n    });\r\n    $(\"#down\").click(function (e) {\r\n        if (activeSelected && selectedFields.indexOf(activeSelected) < selectedFields.length) {\r\n            var index = selectedFields.indexOf(activeSelected);\r\n            selectedFields.splice(index, 1);\r\n            selectedFields.splice(index + 1, 0, activeSelected);\r\n            populateSelected();\r\n            $(\"#selected-\" + selectedFields[selectedFields[index + 1] ? index + 1 : index].name.sanitize()).click();\r\n        }\r\n    });\r\n    String.prototype.sanitize = function () {\r\n        return this.replace(/\\s/g, \"-\");\r\n    };\r\n});\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/wiprint-admin.ts\n// module id = 6\n// module chunks = 1"],"sourceRoot":""}