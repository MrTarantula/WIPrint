define(["TFS/WorkItemTracking/RestClient","TFS/WorkItemTracking/Contracts","moment","q"],function(e,t,n,r){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=7)}([function(t,n){t.exports=e},function(e,n){e.exports=t},,,function(e,t){e.exports=n},function(e,t){e.exports=r},,function(e,t,n){var r,i;r=[n,t,n(0),n(1),n(4),n(5)],void 0!==(i=function(e,t,n,r,i,o){"use strict";function s(e){return a.then(function(t){return e.map(function(e){return t.getValue("wiprint-"+e.fields["System.WorkItemType"].sanitize(),{scopeType:"user",defaultValue:d}).then(function(t){var n='<div class="item"><h2>'+e.fields["System.WorkItemType"]+" "+e.id+" - "+e.fields["System.Title"]+"</h2>";return t.forEach(function(t){e.fields[t.referenceName]&&(i(e.fields[t.referenceName],"YYYY-MM-DDTHH:mm:ss.SSSZ",!0).isValid()?n+="<p><b>"+t.name+":</b> "+i(e.fields[t.referenceName]).format("MM/DD/YYYY")+"</p>":e.fields[t.referenceName]instanceof Array?(n+="<p><b>"+t.name+":</b></p>",e.fields[t.referenceName].forEach(function(e){n+="<p>"+e+"</p>"})):i(e.fields[t.referenceName],"YYYY-MM-DDTHH:mm:ss.SSSZ").isValid()||(n+="<p><b>"+t.name+":</b> "+e.fields[t.referenceName]+"</p>"))}),n+="</div>"})})})}function c(e){o.all(s(e)).then(function(e){e.forEach(function(e){o.resolve(e).then(function(e){return document.getElementById("workitems").innerHTML+=e})})}).then(function(){window.focus(),window.print(),document.getElementById("workitems").innerHTML=""})}Object.defineProperty(t,"__esModule",{value:!0});var u=VSS.getExtensionContext(),a=VSS.getService(VSS.ServiceIds.ExtensionData),m=VSS.getWebContext(),f=n.getClient(),d=[{name:"Assigned To",referenceName:"System.AssignedTo"},{name:"State",referenceName:"System.State"},{name:"Created Date",referenceName:"System.CreatedDate"},{name:"Description",referenceName:"System.Description"},{name:"Acceptance Criteria",referenceName:"Microsoft.VSTS.Common.AcceptanceCriteria"},{name:"History",referenceName:"System.History"}];String.prototype.sanitize=function(){return this.replace(/\s/g,"-")};var p={getMenuItems:function(e){var t="Print";return e.workItemIds&&e.workItemIds.length>1&&(t="Print Selection"),[{action:function(e){var t=e.workItemIds||e.ids||[e.workItemId];return f.getWorkItems(t,void 0,void 0,r.WorkItemExpand.Fields).then(function(e){return c(e)})},icon:"static/img/print14.png",text:t,title:t}]}},l={getMenuItems:function(e){return[{action:function(e){return f.queryByWiql({query:e.query.wiql},m.project.name,m.team.name).then(function(e){return e.workItemRelations?e.workItemRelations.map(function(e){return e.target.id}):e.workItems.map(function(e){return e.id})}).then(function(e){return f.getWorkItems(e,void 0,void 0,r.WorkItemExpand.Fields).then(function(e){return c(e)})})},icon:"static/img/print16.png",text:"Print All",title:"Print All"}]}};VSS.register(u.publisherId+"."+u.extensionId+".print-work-item",p),VSS.register(u.publisherId+"."+u.extensionId+".print-query-toolbar",l),VSS.register(u.publisherId+"."+u.extensionId+".print-query-menu",l),VSS.register("print-work-item",p),VSS.register("print-query-menu",l)}.apply(t,r))&&(e.exports=i)}])});
//# sourceMappingURL=wiprint.js.map